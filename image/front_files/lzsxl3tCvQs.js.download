;/*FB_PKG_DELIM*/

__d("PolarisAPIRetrieveUserCallSettings",["PolarisInstapi","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield d("PolarisInstapi").apiGet("/api/v1/video_call/retrieve_user_call_settings/"));return a.data});return h.apply(this,arguments)}g.retrieveUserCallSettings=a}),98);
__d("IGDCallButton.react",["FBLogger","I64","IGDSCallPanoOutline24Icon.react","IGDSIconButton.react","IGDSVideoChatPanoOutlineIcon.react","IGDThreadListNewMessageLoggingDataContext","Int64Hooks","MWPActor.react","MessengerWebUXLogger","PolarisAPIRetrieveUserCallSettings","PolarisCallNavigator","PolarisDirectLogger","PolarisDirectStrings","PolarisInstapi","ReQL","asyncToGeneratorRuntime","gkx","promiseDone","react","react-compiler-runtime","useMsysIgThreadId","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=i||d("react");function l(a,b,c){var e;return(e=d("ReQL")).toArrayAsync(e.leftJoin(e.fromTableAscending(a.tables.participants,["contactId"]).getKeyRange(c).filter(function(a){return!(j||(j=d("I64"))).equal(a.contactId,b)}),e.fromTableAscending(a.tables.ig_contact_info)).map(function(a){a[0];a=a[1];return a}))}function m(a,b){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.contacts).getKeyRange(b).map(function(a){a=a.name;return a}))}function a(a){var e=d("react-compiler-runtime").c(19),f=a.isVideo,g=a.threadKey,i=a.threadType,n=(h||(h=c("useReStore")))(),o=c("useMsysIgThreadId")(g),p=d("MWPActor.react").useActor(),q=d("IGDThreadListNewMessageLoggingDataContext").useFlowInstanceIdContext(),r=c("MessengerWebUXLogger").useInteractionLogger();e[0]===Symbol["for"]("react.memo_cache_sentinel")?(a={eventName:"start_video_chat_button_impression"},e[0]=a):a=e[0];a=c("MessengerWebUXLogger").useImpressionLoggerRef(a);var s,t;e[1]!==p||e[2]!==n||e[3]!==q||e[4]!==f||e[5]!==r||e[6]!==o||e[7]!==g||e[8]!==i?(s=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;a=(a=(yield l(n,p,g)))!=null?a:[];a=(a=a[0])!=null?a:{};var b=a.contactId;a=a.igId;r==null||r({eventName:f?"start_video_chat":"start_audio_call",flowInstanceId:q});if(c("gkx")("24007")){b=b!=null?yield m(n,b):null;if(a==null||i==null||(j||(j=d("I64"))).to_int32(i)!==1)return;a=d("PolarisInstapi").apiGet("/api/v1/friendships/show/{target_user_id}/",{path:{target_user_id:a}});var e=(yield d("PolarisAPIRetrieveUserCallSettings").retrieveUserCallSettings()).setting_type;if(e!=="people_you_follow")return;if((yield a).data.following!==!0){if(b==null){c("FBLogger")("ig_web").mustfix("Unable to open modal - username is null");return}return}}d("PolarisDirectLogger").DirectLogger.logDirectEvent("DirectThread","call_button_click",{has_video:f,ig_thread_id:o});o!=null?d("PolarisCallNavigator").launchCall(o,f):c("FBLogger")("ig_web").mustfix("Unable to initiate call - missing thread id")});return function(){return a.apply(this,arguments)}}(),t=[n,p,g,r,f,q,o,i],e[1]=p,e[2]=n,e[3]=q,e[4]=f,e[5]=r,e[6]=o,e[7]=g,e[8]=i,e[9]=s,e[10]=t):(s=e[9],t=e[10]);var u=d("Int64Hooks").useCallbackInt64(s,t);e[11]!==u?(s=function(){c("promiseDone")(u())},e[11]=u,e[12]=s):s=e[12];e[13]!==f?(t=f?k.jsx(c("IGDSVideoChatPanoOutlineIcon.react"),{alt:d("PolarisDirectStrings").VIDEO_CALL_STRING,color:"ig-primary-text"}):k.jsx(c("IGDSCallPanoOutline24Icon.react"),{alt:d("PolarisDirectStrings").AUDIO_CALL_STRING,color:"ig-primary-text"}),e[13]=f,e[14]=t):t=e[14];var v;e[15]!==a||e[16]!==s||e[17]!==t?(v=k.jsx(c("IGDSIconButton.react"),{innerRef:a,onClick:s,children:t}),e[15]=a,e[16]=s,e[17]=t,e[18]=v):v=e[18];return v}g["default"]=a}),98);
__d("IGDCallButtonAndJoinButtonWithBlockCheck.react",["I64","IGDCallButton.react","IGDJoinCallButton.react","LSContactBitOffset","LSContactBlockedByViewerStatus","LSIntEnum","LSMessagingThreadTypeUtil","LSRtcCallState","LSThreadBitOffset","MWCMThreadTypes.react","MWPActor.react","PolarisDirectLogger","RTWebIncomingRingConfiguration","ReQL","ReQLSuspense","react","react-compiler-runtime","useOngoingCallIsStale","useOngoingCallServerInfoData","useOngoingCallState","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=k||d("react");function m(a){var b=d("react-compiler-runtime").c(9),e=(h||(h=c("useReStore")))(),g=d("MWPActor.react").useActor(),k;b[0]!==g||b[1]!==e||b[2]!==a.threadKey||b[3]!==a.threadType?(k=function(){return d("LSMessagingThreadTypeUtil").isOneToOne(a.threadType)?d("ReQL").mergeJoin(d("ReQL").fromTableAscending(e.tables.participants).getKeyRange(a.threadKey),d("ReQL").fromTableAscending(e.tables.contacts)).map(n).filter(function(a){return(i||(i=d("I64"))).equal(a.id,g)?!1:!(i||(i=d("I64"))).equal(a.blockedByViewerStatus,(j||(j=d("LSIntEnum"))).ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED))}):d("ReQL").empty()},b[0]=g,b[1]=e,b[2]=a.threadKey,b[3]=a.threadType,b[4]=k):k=b[4];var l;b[5]!==g||b[6]!==e||b[7]!==a?(l=[e,a,g],b[5]=g,b[6]=e,b[7]=a,b[8]=l):l=b[8];return d("ReQLSuspense").useFirst(k,l,f.id+":55")!=null}function n(a){a=a[1];return a}function o(){var a=d("react-compiler-runtime").c(6),b=(h||(h=c("useReStore")))(),e=d("MWPActor.react").useActor(),g;a[0]!==e||a[1]!==b.tables.contacts?(g=function(){return d("ReQL").fromTableAscending(b.tables.contacts).getKeyRange(e)},a[0]=e,a[1]=b.tables.contacts,a[2]=g):g=a[2];var i;a[3]!==e||a[4]!==b?(i=[b,e],a[3]=e,a[4]=b,a[5]=i):i=a[5];return d("ReQLSuspense").useFirst(g,i,f.id+":82")}function a(a){var b=d("react-compiler-runtime").c(22);a=a.thread;var e=d("LSMessagingThreadTypeUtil").isIGDMessageRequest(a),f=d("LSMessagingThreadTypeUtil").isOneToOne(a.threadType),g=o();g=g!=null?d("LSContactBitOffset").has(23,g):void 0;var h=m(a),k=c("useOngoingCallServerInfoData")(a.threadKey),n=c("useOngoingCallState")(a.threadKey),p=c("useOngoingCallIsStale")(a.threadType,k!=null,a.ongoingCallTimestampMs);n=!(i||(i=d("I64"))).equal(n,(j||(j=d("LSIntEnum"))).ofNumber(c("LSRtcCallState").AUDIO_GROUP_CALL))&&!(i||(i=d("I64"))).equal(n,(j||(j=d("LSIntEnum"))).ofNumber(c("LSRtcCallState").AUDIO_1TO1_CALL));var q;b[0]!==a.threadSubtype?(q=a.threadSubtype!=null&&d("MWCMThreadTypes.react").isIGBroadcastChannelThread(a.threadSubtype),b[0]=a.threadSubtype,b[1]=q):q=b[1];q=q;var r,s,t;if(b[2]!==q||b[3]!==a){var u=d("LSThreadBitOffset").has(24,a),v=d("LSThreadBitOffset").has(25,a);r=d("RTWebIncomingRingConfiguration").isSupportedClient();t=!q&&v;s=!q&&u;(t||s)&&d("PolarisDirectLogger").DirectLogger.logDirectEvent("DirectThread","call_button_impression",{isRTCVideoCallEnabled:u,isRTCVoiceCallEnabled:v});b[2]=q;b[3]=a;b[4]=r;b[5]=s;b[6]=t}else r=b[4],s=b[5],t=b[6];if(h||e||!f&&g===!0||!r)return null;else if(k!=null&&p!==!0){d("PolarisDirectLogger").DirectLogger.logDirectEvent("DirectThread","join_button_impression",{has_video:n,server_info_data:k});b[7]!==n||b[8]!==k||b[9]!==a.threadKey?(u=l.jsx(c("IGDJoinCallButton.react"),{isVideo:n,serverInfoData:k,threadKey:a.threadKey}),b[7]=n,b[8]=k,b[9]=a.threadKey,b[10]=u):u=b[10];return u}else{b[11]!==t||b[12]!==a.threadKey||b[13]!==a.threadType?(v=t?l.jsx(c("IGDCallButton.react"),{isVideo:!1,threadKey:a.threadKey,threadType:a.threadType}):null,b[11]=t,b[12]=a.threadKey,b[13]=a.threadType,b[14]=v):v=b[14];b[15]!==s||b[16]!==a.threadKey||b[17]!==a.threadType?(q=s?l.jsx(c("IGDCallButton.react"),{isVideo:!0,threadKey:a.threadKey,threadType:a.threadType}):null,b[15]=s,b[16]=a.threadKey,b[17]=a.threadType,b[18]=q):q=b[18];b[19]!==v||b[20]!==q?(h=l.jsxs(l.Fragment,{children:[v,q]}),b[19]=v,b[20]=q,b[21]=h):h=b[21];return h}}g["default"]=a}),98);